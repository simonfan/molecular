//     subject
//     (c) simonfan
//     subject is licensed under the MIT terms.

//     Molecular
//     (c) sfan
//     Molecular is licensed under the MIT terms.

define("__subject/private/assign",["require","exports","module","lodash"],function(e,t,i){function n(e,t,i){if(s.defaults(i,a),!s.isArray(t))throw new Error("Currently subject.assign does not accept non-array properties for accessor assignment.");s.each(t,function(t){var n=s.extend({},i);n.get&&(n.get=s.partial(n.get,t)),n.set&&(n.set=s.partial(n.set,t)),Object.defineProperty(e,t,n)})}function r(e,t,i){s.defaults(i,o),s.each(t,function(t,n){var r=s.assign({value:t},i);Object.defineProperty(e,n,r)})}var s=e("lodash"),a={configurable:!0,enumerable:!0},o=s.extend({writable:!0},a);i.exports=function(e,t,i){return i?i.get||i.set?n(e,t,i):r(e,t,i):s.assign(e,t),e}}),define("__subject/public/assign-proto",["require","exports","module","lodash","../private/assign"],function(e,t,i){var n=e("lodash"),r=e("../private/assign");i.exports=function(){var e,t;return n.isObject(arguments[0])?(e=arguments[0],t=arguments[1]):n.isString(arguments[0])&&(e={},e[arguments[0]]=arguments[1],t=arguments[2]),r(this.prototype,e,t),this}}),define("__subject/public/proto-merge",["require","exports","module","lodash","../private/assign"],function(e,t,i){var n=e("lodash"),r=e("../private/assign");i.exports=function(){var e,t,i;if(n.isString(arguments[0])){var s=arguments[0];e=this.prototype[s],t=arguments[1],i=arguments[2],this.prototype[s]=r(n.create(e),t,i)}else i=arguments[1],n.each(arguments[0],n.bind(function(e,t){this.protoMerge(t,e,i)},this));return this}}),define("__subject/public/extend",["require","exports","module","lodash","../private/assign"],function(e,t,i){var n=e("lodash"),r=e("../private/assign");i.exports=function(e,t){var i,s=this;return i=function(){var e=n.create(i.prototype);return e.initialize.apply(e,arguments),e},r(i,n.pick(s,s.staticProperties),{enumerable:!1}),i.prototype=n.create(s.prototype),i.assignProto(e,t),r(i.prototype,{constructor:i,__super__:s.prototype},{enumerable:!1}),i}}),define("subject",["require","exports","module","lodash","./__subject/private/assign","./__subject/public/assign-proto","./__subject/public/assign-proto","./__subject/public/proto-merge","./__subject/public/extend"],function(e,t,i){var n=e("lodash"),r=e("./__subject/private/assign"),s=function(){};s.prototype=r({},{initialize:function(){}},{enumerable:!1}),r(s,{staticProperties:["proto","assignProto","protoMerge","staticProperties","assignStatic","extend"],assignStatic:function(){var e,t,i;return n.isString(arguments[0])?(e={},e[arguments[0]]=arguments[1],t=[arguments[0]],i=arguments[2]):n.isObject(arguments[0])&&(e=arguments[0],t=n.keys(e),i=arguments[1]),this.staticProperties=n.union(this.staticProperties,t),r(this,e,i)},assignProto:e("./__subject/public/assign-proto"),proto:e("./__subject/public/assign-proto"),protoMerge:e("./__subject/public/proto-merge"),extend:e("./__subject/public/extend")},{enumerable:!1}),i.exports=n.bind(s.extend,s);var a={assign:r};r(i.exports,a,{enumerable:!1,writable:!1,configurable:!1})}),define("molecular/auxiliary",["require","exports","module"],function(e,t){t.transfer=function(e,t,i){_.each(e,function(e){i[e]||(i[e]=t[e])})},t.toCamelCase=function(e){return e.replace(/[-_\s]+(.)?/g,function(e,t){return t?t.toUpperCase():""})},t.toDashed=function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}}),define("molecular/node/event-system",["require","exports","module","es5-shim"],function(e,t){e("es5-shim"),t.addEventListener=function(e,t){this._eventHandlers[e]=this._eventHandlers[e]||[],this._eventHandlers[e].push(t)},t.emit=function(e,t){t=t||{},t.type||(t.type=e),t.emitter||(t.emitter=this);var i=!0;if(t.stopPropagation=function(){i=!1},_.each(this._eventHandlers[e],function(e){e(t)}),i){var n=this.getParent();n&&n.emit(e,t)}}}),define("molecular/node/command-system",["require","exports","module","es5-shim","q"],function(e,t){function i(e){var t=this.getParent();t&&(t.handleCommand(e),e.promise.isPending()&&i.call(t,e))}function n(e){for(var t=this.children,i=0,r=t.length;e.promise.isPending()&&r>i;){var s=t[i];s.handleCommand(e),e.promise.isPending()&&n.call(s,e),++i}}e("es5-shim");var r=e("q");t.issueCommand=function(e,t){var s=r.defer();return t=t||e.propagation||"bubble",s.issuer=e.issuer||this,s.name=e.name||e.command,s.data=e,s.propagation=t,this.handleCommand(s),s.promise.isPending()&&(t&&"bubble"!==t?"capture"===t?n.call(this,s):(i.call(this,s),s.promise.isPending()&&n.call(this,s)):i.call(this,s)),s.promise.fail(this.handleCommandFailure.bind(this)),s.promise},t.handleCommand=function(e){var t=e.data,i=t.name;this[i]&&this[i](e)},t.handlePendingCommand=function(e){e.resolve()},t.handleCommandFailure=function(e){throw e}}),define("molecular/node",["require","exports","module","subject","molecular/auxiliary","molecular/node/event-system","molecular/node/command-system"],function(e,t,i){var n=e("subject"),r=e("molecular/auxiliary"),s=n({initialize:function(e){e=e||{},r.transfer(["parent"],e,this),this.children=[],this._eventHandlers={}},getParent:function(){return this.parent},setParent:function(e){return this.parent=e,this},addChildren:function(e){return Array.isArray(e)?e.forEach(function(e){e.setParent(this),this.children.push(e)}.bind(this)):(e.setParent(this),this.children.push(e)),this}});s.assignProto(e("molecular/node/event-system")).assignProto(e("molecular/node/command-system")),i.exports=s}),define("molecular/view/directives/dom-events",["require","exports","module"],function(e,t){function i(e){this[e].apply(this,_.toArray(arguments).slice(2))}t.mClick=function(e,t){e.on("click",_.partial(i,t,e).bind(this))},t.mMouseover=function(e,t){e.on("mouseover",_.partial(i,t,e).bind(this))}}),define("molecular/view/directives",["require","exports","module","es5-shim","lodash","molecular/view/directives/dom-events"],function(e,t){e("es5-shim");var i=e("lodash");i.assign(t,e("molecular/view/directives/dom-events")),t.mView=function(t,i){e([i],function(e){var i=e({element:t});this.addChildren(i)}.bind(this))},t.mClickCommand=function(e,t){t=i.isString(t)?JSON.parse(t):t,e.on("click",function(){this.issueCommand(t)}.bind(this))}}),define("molecular/view/dom-manipulation",["require","exports","module","jquery"],function(e,t){t.DOMElementAdapter=e("jquery")}),define("molecular/view/rendering",["require","exports","module","es5-shim","lodash"],function(e,t){e("es5-shim");var i=e("lodash");t.render=function(e){var t,n=this.template;if(n){var r=this.parseTemplateData(e);i.isString(n)&&(n=this.template=this.compileTemplate(n)),t=n(r),this.element.html(t)}return this},t.parseTemplateData=function(e){return e},t.template=void 0,t.compileTemplate=i.template}),define("molecular/view",["require","exports","module","lodash","molecular/node","molecular/auxiliary","molecular/view/directives","molecular/view/dom-manipulation","molecular/view/rendering"],function(e,t,i){function n(e,t){var i="[data-"+a.toDashed(t)+"]";return e.find(i)}var r=e("lodash"),s=e("molecular/node"),a=e("molecular/auxiliary"),o=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),a.transfer(["element","template","render","compileTemplate"],e,this),this.element=this.DOMElementAdapter(e.element),this.render(e),r.each(this.directives,function(e,t){var i=n(this.element,t);r.each(i,function(i){i=this.DOMElementAdapter(i);var n=i.data(t);e.call(this,i,n)}.bind(this))}.bind(this))},directives:e("molecular/view/directives")});o.assignProto(e("molecular/view/dom-manipulation")).assignProto(e("molecular/view/rendering"));var u=o.extend;o.assignStatic("extend",function(e,t){return e.directives=r.assign({},this.prototype.directives,e.directives),u.call(this,e,t)}),i.exports=o}),define("molecular",["require","exports","module","molecular/node","molecular/view"],function(e,t){t.node=e("molecular/node"),t.view=e("molecular/view")});